{
  "version": 3,
  "sources": ["../../../src/lib/stripe/StripeFormWrapper.tsx"],
  "sourcesContent": ["import React, { FC, ReactElement } from 'react';\nimport * as Stripe from '@stripe/stripe-js';\nimport { CardElement, Elements, useElements, useStripe } from '@stripe/react-stripe-js';\nimport { FormikConfig, FormikHelpers, FormikProps } from 'formik';\nimport { Form } from '../form';\n\nexport interface StripeFormWrapperProps extends FormikConfig<any> {\n  className?: string;\n  onError?: (reason: string) => void;\n  children: (formikProps: FormikProps<any>) => ReactElement;\n}\n\nconst StripeFormWrapperContent: FC<StripeFormWrapperProps> = props => {\n  const elements = useElements();\n  const stripe = useStripe();\n  const { onSubmit, onError, ...formikConfig } = props;\n\n  const handleSubmit = async (values: any, formikHelpers: FormikHelpers<any>) => {\n    const { setSubmitting, setStatus } = formikHelpers;\n    const handleError = (reason: string) => {\n      setSubmitting(false);\n      return onError && onError(reason);\n    };\n\n    setSubmitting(true);\n\n    if (!elements) return handleError('no stripe elements');\n\n    const card = elements.getElement(CardElement);\n    if (!card) return handleError('no stripe card');\n\n    const result = await stripe?.createToken(card);\n    if (result?.error) return setStatus({ serverErrors: [result.error.message] });\n\n    if (!result?.token) return handleError('no stripe token');\n\n    setStatus({ serverErrors: [] });\n    onSubmit({ values, token: result.token }, formikHelpers);\n  };\n\n  return <Form {...formikConfig} {...props} onSubmit={handleSubmit} />;\n};\n\n// Setup Stripe.js and the Elements provider\nexport const StripeFormWrapper: FC<{ STRIPE_KEY?: string } & StripeFormWrapperProps> = ({ STRIPE_KEY, ...props }) => {\n  if (!STRIPE_KEY) throw new Error('STRIPE_KEY is required for StripeFormWrapper');\n\n  const stripePromise = Stripe.loadStripe(STRIPE_KEY);\n\n  return (\n    <Elements stripe={stripePromise}>\n      <StripeFormWrapperContent {...props} />\n    </Elements>\n  );\n};\n"],
  "mappings": "+kBAAA,qBACA,oCACA,oGAEA,+BAQA,KAAM,GAAuD,GAAS,CACpE,KAAM,GAAW,IACX,EAAS,IACgC,IAAvC,YAAU,WAA6B,EAAjB,IAAiB,EAAjB,CAAtB,WAAU,YAEZ,EAAe,MAAO,EAAa,IAAsC,CAC7E,KAAM,CAAE,gBAAe,aAAc,EAC/B,EAAc,AAAC,GACnB,GAAc,IACP,GAAW,EAAQ,IAK5B,GAFA,EAAc,IAEV,CAAC,EAAU,MAAO,GAAY,sBAElC,KAAM,GAAO,EAAS,WAAW,GACjC,GAAI,CAAC,EAAM,MAAO,GAAY,kBAE9B,KAAM,GAAS,KAAM,kBAAQ,YAAY,IACzC,GAAI,iBAAQ,MAAO,MAAO,GAAU,CAAE,aAAc,CAAC,EAAO,MAAM,WAElE,GAAI,CAAC,kBAAQ,OAAO,MAAO,GAAY,mBAEvC,EAAU,CAAE,aAAc,KAC1B,EAAS,CAAE,SAAQ,MAAO,EAAO,OAAS,IAG5C,MAAO,iBAAC,EAAD,SAAU,GAAkB,GAA5B,CAAmC,SAAU,MAIzC,EAA0E,AAAC,GAA6B,CAA7B,QAAE,eAAF,EAAiB,IAAjB,EAAiB,CAAf,eACxF,GAAI,CAAC,EAAY,KAAM,IAAI,OAAM,gDAEjC,KAAM,GAAgB,EAAO,WAAW,GAExC,MACE,iBAAC,EAAD,CAAU,OAAQ,GAChB,gBAAC,EAAD,KAA8B",
  "names": []
}
