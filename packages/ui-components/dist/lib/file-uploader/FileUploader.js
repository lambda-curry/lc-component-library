var R=Object.defineProperty;var p=Object.getOwnPropertySymbols;var m=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var C=(i,n,o)=>n in i?R(i,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[n]=o,f=(i,n)=>{for(var o in n||(n={}))m.call(n,o)&&C(i,o,n[o]);if(p)for(var o of p(n))L.call(n,o)&&C(i,o,n[o]);return i};var A=(i,n)=>{var o={};for(var s in i)m.call(i,s)&&n.indexOf(s)<0&&(o[s]=i[s]);if(i!=null&&p)for(var s of p(i))n.indexOf(s)<0&&L.call(i,s)&&(o[s]=i[s]);return o};import e,{useEffect as k}from"react";import{useDropzone as P}from"react-dropzone";import{get as M}from"lodash";import O from"classnames";import{ButtonUnstyled as ee}from"../buttons/ButtonUnstyled";import{ButtonAccent as le}from"../buttons/ButtonAccent";import{ButtonLink as ie}from"../buttons/ButtonLink";import{Icon as oe}from"../icon/Icon";import{formatBytes as V,formatMimeTypesForDisplay as ne}from"./FileUploader.helpers";import te from"../../assets/file-uploader-placeholder.js";import"./file-uploader.css";const Ee=se=>{var w=se,{name:i,className:n,replaceOnly:o,maxSize:s=1048576,minSize:F,accept:v=["image/jpeg","image/png","image/gif"],multiple:r=!1,disabled:g,dropzoneText:$,dropzoneActiveText:I,dropzoneAcceptText:T,dropzoneRejectText:x,formikProps:l,onDrop:h,onDropAccepted:z,onDropRejected:N,onClearAll:U,onRemoveFile:b}=w,y=A(w,["name","className","replaceOnly","maxSize","minSize","accept","multiple","disabled","dropzoneText","dropzoneActiveText","dropzoneAcceptText","dropzoneRejectText","formikProps","onDrop","onDropAccepted","onDropRejected","onClearAll","onRemoveFile"]);const d=l?M(l==null?void 0:l.values,i)||[]:y.value||[],q=l?M(l==null?void 0:l.errors,i):y.error||"";k(()=>()=>{d.forEach(t=>URL.revokeObjectURL(t.preview))},[d]);const _=t=>Object.assign(t,{preview:URL.createObjectURL(t)}),G=t=>{const a=[...r?d:[],...t.map(c=>_(c))].reduce((c,j)=>(c[j.path]=j,c),{});return Object.values(a)},H=(t,u,a)=>{const c=G(t);(l==null?void 0:l.setFieldValue)&&l.setFieldValue(i,c),(l==null?void 0:l.setFieldError)&&l.setFieldError(i,""),h&&h(c,u,a),z&&z(c,a),N&&N(u,a)},J=()=>{(l==null?void 0:l.setFieldValue)&&l.setFieldValue(i,[]),(l==null?void 0:l.setFieldError)&&l.setFieldError(i,void 0),U&&U()},K=(t,u)=>{t.stopPropagation();const a=[...d],c=a.splice(u,1)[0];(l==null?void 0:l.setFieldValue)&&l.setFieldValue(i,a),b&&b(u,c,a)},Q={maxSize:s,minSize:F,accept:v,multiple:r,disabled:g,onDrop:H},{getRootProps:W,getInputProps:X,isDragActive:D,isDragAccept:B,isDragReject:E,open:Y}=P(Q),Z=()=>B?T||`${r?"All files":"The file"} will be accepted.`:E?x||`${r?"Some files":"The file"} will be rejected.`:D?I||`Drop the file${r&&"s"} here...`:$||`Drag 'n drop ${r?"some files":"a file"} here, or click to select ${r?"some":"one"}.`,S=O("lc-file-uploader-dropzone",{"lc-file-uploader-dropzone-active":D,"lc-file-uploader-dropzone-accept":B,"lc-file-uploader-dropzone-reject":E});return e.createElement(e.Fragment,null,e.createElement("div",{className:O("lc-file-uploader",n,{"lc-file-uploader-disabled":g})},e.createElement("div",f({},W({className:S})),e.createElement("input",f({name:i},X())),d&&d.length>0&&e.createElement("ul",{className:"lc-file-uploader-dropzone-files"},d.map((t,u)=>e.createElement("li",{key:u},e.createElement(ee,{className:"lc-file-uploader-dropzone-file",disabled:o,onClick:a=>K(a,u)},e.createElement("div",{className:"lc-file-uploader-dropzone-file-thumb"},e.createElement("img",{src:t.preview,alt:"File upload preview",className:"lc-file-uploader-dropzone-file-thumb-image"}),e.createElement("div",{className:"lc-file-uploader-dropzone-file-thumb-overlay"},e.createElement(oe,{name:"trash",className:"lc-file-uploader-dropzone-file-remove-icon"}))),r&&t.name&&e.createElement("div",{className:"lc-file-uploader-dropzone-file-name"},t.name))))),(!d||d.length<1)&&e.createElement(e.Fragment,null,e.createElement("img",{alt:"File upload placeholder",src:te,className:"lc-file-uploader-dropzone-placeholder"}),e.createElement("div",{className:"lc-file-uploader-dropzone-text"},Z()))),e.createElement("div",{className:"lc-file-uploader-footer"},e.createElement("div",{className:"lc-file-uploader-actions"},e.createElement(le,{onClick:Y},"Choose File",r&&"s"),(d&&d.length>0&&!o||q)&&e.createElement(ie,{onClick:J,style:{marginLeft:"12px"}},"Clear ",r&&e.createElement(e.Fragment,null,"All"))),e.createElement("div",{className:"lc-flex-1"}),e.createElement("div",{className:"lc-file-uploader-restrictions"},v&&e.createElement(e.Fragment,null,ne(v),". "),s&&e.createElement(e.Fragment,null,"Max size of ",V(s),". "),F&&e.createElement(e.Fragment,null,"Min size of ",V(F),".")))))};export{Ee as FileUploader};
//# sourceMappingURL=FileUploader.js.map
