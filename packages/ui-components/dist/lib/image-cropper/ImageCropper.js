var $=Object.defineProperty,R=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var O=(e,r,o)=>r in e?$(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,n=(e,r)=>{for(var o in r||(r={}))T.call(r,o)&&O(e,o,r[o]);if(g)for(var o of g(r))j.call(r,o)&&O(e,o,r[o]);return e},C=(e,r)=>R(e,ee(r));var S=(e,r)=>{var o={};for(var t in e)T.call(e,t)&&r.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&g)for(var t of g(e))r.indexOf(t)<0&&j.call(e,t)&&(o[t]=e[t]);return o};import a,{useState as m,useEffect as U}from"react";import re from"react-image-crop";import{Modal as oe}from"../modal/Modal";import{ModalHeader as ae}from"../modal/ModalHeader";import{Button as pe}from"../buttons/Button";import{ButtonPrimary as te}from"../buttons/ButtonPrimary";import{formatBytes as ie}from"../file-uploader/FileUploader.helpers";import{getCroppedImage as se}from"./ImageCropper.helpers";import"react-image-crop/dist/ReactCrop.css";import"./image-cropper.css";import le from"classnames";const He=me=>{var P=me,{src:e,file:r,mimeType:o="image/jpeg",fileName:t="newFile.jpg",quality:ne=.85,isOpen:f,onSave:y,onCancel:N,onAfterOpen:B,onAfterClose:M,ruleOfThirds:A=!0,modalTitle:q="Crop your image",className:z}=P,L=S(P,["src","file","mimeType","fileName","quality","isOpen","onSave","onCancel","onAfterOpen","onAfterClose","ruleOfThirds","modalTitle","className"]);const l=n({unit:"%",width:100,height:100,y:0,x:0},L.initialCrop),[c,u]=m(l),[D,v]=m(!!f),[G,b]=m(null),[i,J]=m(null),[H,k]=m(!1),x=r?r.preview:e,K=l.unit==="%",E=l.aspect;U(()=>{v(!!f)},[f]),U(()=>()=>{i&&URL.revokeObjectURL(i.preview)},[]);function h(p,s){return K&&s?C(n({},s),{aspect:E}):C(n({},p),{aspect:E})}const I=async(p,s)=>{let d=null;const w=s||G;return w&&(k(!0),w&&c.width&&c.height&&(d=await se({image:w,crop:h(p),fileName:t,mimeType:o}),J(d)),k(!1)),d},Q=async()=>{B&&B()},V=()=>{u(l),M&&M()},W=(p,s)=>{u(h(p,s))},X=async(p,s)=>{await I(h(p,s))},Y=async p=>(b(p),await I(l,p),!1),F=()=>{u(l),b(null)},Z=()=>{v(!1),F(),N&&N()},_=async()=>{let p=i;p=await I(c),v(!1),F(),y&&y(p)};return x?a.createElement(oe,{className:le("lc-image-cropper-modal",z),isOpen:D,onAfterOpen:Q,onAfterClose:V,closeButton:!1},a.createElement(ae,{className:"lc-image-cropper-header",title:q}),a.createElement("div",{className:"lc-image-cropper-cropper"},a.createElement(re,C(n({},L),{src:x,crop:c,onChange:W,onComplete:X,onImageLoaded:Y,ruleOfThirds:A,crossorigin:"anonymous"}))),a.createElement("div",{className:"lc-image-cropper-footer"},i&&i.preview&&a.createElement("div",{className:"lc-image-cropper-preview"},a.createElement("div",{className:"lc-image-cropper-preview-image"},a.createElement("img",{src:i.preview,alt:"crop preview"})),a.createElement("div",{className:"lc-image-cropper-preview-info"},a.createElement("strong",null,"Preview"),a.createElement("br",null),i.width," x ",i.height," (",ie(i.file.size),")")),a.createElement("div",{className:"lc-flex-1"}),a.createElement("div",{className:"lc-image-cropper-actions"},a.createElement(pe,{onClick:Z,disabled:H},"Cancel"),a.createElement(te,{onClick:_,disabled:H},"Save")))):null};export{He as ImageCropper};
//# sourceMappingURL=ImageCropper.js.map
